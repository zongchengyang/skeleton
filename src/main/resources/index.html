<html><head>
    <link rel="stylesheet" href="style.css">
    <script data-require="jquery@*" data-semver="3.1.1" src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script>

        $(document).on('click','.add-tag',function(){
            $(this).after("<input class='tag_input' type='text'></input>");
        });

        $(document).on('click','.tagValue',function(){
            $.ajax({
                type: 'PUT',
                data: $(this).parent().parent().attr('id'),
                url: '/tags/'+$(this).text(),
                success: function(data) {},
                contentType: "application/json",
                dataType: 'json',
            });
            $(this).remove();
        });

        $(document).on('keypress','.tag_input',function(e){
            if(e.keyCode == 13){
                $.ajax({
                    type: 'PUT',
                    data: $(this).parent().parent().attr('id'),
                    url: '/tags/'+$(this).val(),
                    success: function(data) {
                    },
                    contentType: "application/json",
                    dataType: 'json',
                });
                $(`<button class="tagValue">${$(this).val()}</button>`).appendTo($('.tagValueBox', $("#"+$(this).parent().parent().attr('id'))));
                $(this).remove();
            }
        });


        $(document).ready(function(){
            $("#cancel-receipt").click(function(){
                $("#allReceipts").hide();
            });
            $("#cancel-receipt").click(function(){
                $("#allReceipts").hide();
            });
            $("#add-receipt").click(function(){
                $("#allReceipts").show();
            });

            $("#save-receipt").click(function(){
                $.ajax({
                    type: 'POST',
                    data: JSON.stringify({"merchant":$("#merchant").val(),"amount":$("#amount").val()}),
                    url: '/receipts',
                    success: function(data) {
                        var t = new Date().getHours() + ":" + new Date().getMinutes() + ":" + new Date().getSeconds();
                        $(`<div class="receipt" id="${data}">Time: <div class="time">${t}</div>Name: <div class="merchant">${$("#merchant").val()}</div>
                        Amount: <div class="amount">${$("#amount").val()}</div> <div class="tagValueBox"><button class="add-tag">Click me add tag</button></div>`).appendTo($("#receiptList"));
                    },
                    contentType: "application/json",
                    dataType: 'json'
                });

            });
        });
    </script>
    <style>
        H1 {float: left;}
        .merchant,.amount ,.time{
            padding:10px;
            display:inline;
        }
        .receipt{
            border: 1px solid red;
            font-size: x-large;
        }
        .button{
            background-color: darkblue;
            border: 1px solid darkblue;
            width: 100px;
            float: right;
            font-size: 2em;
            color: white;
            text-align: center;
        }
        #receiptList {
            clear: both;
            width: 500px;
            color: black;
            background: black;
        }
        .receipt {
            background-color: #eee;
            margin-bottom: 5px;
        }
        #allReceipts{
            position: relative;
            width: 400px;
            background: lightpink;
            border: 1px solid black;
            margin-top: 12px;
            margin-bottom: 15px;
            display: none;
        }
        #allReceipts input {
            margin-top: 6px;
            width: 85%;
            background: inherit;
            border: 1px solid black;
            color: white;
            padding-left: 10px;
            font-size: 16px;
            margin-bottom: 10px;
            margin-left: 22px;
            height: 30px;
        }
        .button-class {
            margin-left: 180px;
            margin-bottom: 10px;
            margin-top: 10px;
        }
        #cancel-receipt {
            cursor: pointer;
            border-radius: 3px;
            display: inline-block;
            background-color: lightcoral;
            border: 1px solid black;
            width: 100px;
            font-size: 1em;
            color: white;
        }
        #save-receipt {
            cursor: pointer;
            border-radius: 3px;
            display: inline-block;
            background-color: lightseagreen;
            border: 1px solid black;
            width: 100px;
            font-size: 1em;
            color: white;
        }
        .tag_input{
            background-color: greenyellow;
            height:50px;
            margin-left:0px;
            width:500px;
            font-size: x-large;
        }
        .add-tag{
            background-color: yellow;
            height:50px;
            margin-left:0px;
            width:500px;
            font-size: x-large;
        }
        .tagValue{
            background-color: greenyellow;
            height:50px;
            margin-left:0px;
            width:500px;
            font-size: x-large;
        }
        #add-receipt {
            background-color: darkblue;
        }
    </style>
</head>
<body>

<div id="container">
    <h1>My receipts - zy338</h1>
    <div id="add-receipt" class="button">+</div>
    <div style="float:right;margin-right:10px;display:none;" id="allReceipts">
        <input id="merchant" placeholder="name" type="text" name="bday">
        <input placeholder="amount" id="amount" type="text">
        <div class="button-class">
            <button id="cancel-receipt">cancel</button>
            <button id="save-receipt">save</button>
        </div>
    </div>
    <div id="receiptList"></div>
</div>
</body></html>